<!DOCTYPE html>
<html lang="en-US">
<head>
<title>Video Patterns</title>
<meta name='robots' content='noindex,nofollow' /> 
<% production=1 %>
<% if (production) { %>
<link rel="stylesheet" href="/vi-lab/css/video-patterns-style.min.css">
<script src="/vi-lab/js/video-patterns.min.js"></script>
<% }else{ %>
<link rel="stylesheet" href="/vi-lab/css/bootstrap.min.css">
<link rel="stylesheet" href="/vi-lab/css/colorbox.css" >
<link rel="stylesheet" href="/vi-lab/css/video-patterns.css" >
<script src='/vi-lab/js/jquery-1.11.2.min.js' type='text/javascript'></script>
<script src="/vi-lab/js/bootstrap.min.js"></script>
<script src="/vi-lab/js/bootstrap-switch.min.js"></script>
<script src="/vi-lab/js/markdown.js"></script>
<script src="/vi-lab/js/jquery.colorbox-min.js"></script>
<script src="/vi-lab/js/jquery-image-loader.js"></script>
<script src='/vi-lab/js/db.js'></script>
<script src='/vi-lab/js/typeahead.bundle.js'></script>
<script src="/socket.io/socket.io.js" type='text/javascript'></script>
<% } %>
<link href='https://fonts.googleapis.com/css?family=Oswald:400,300,700|Roboto|Droid+Sans:400,700' rel='stylesheet' type='text/css'>
<script src="/vi-lab/js/require.js" data-main="/vi-lab/js/requirejs-conf"></script>

<script type="text/javascript"> 
$(document).ready (function () {  

	$('.mark').each(function(i, val){
		$(val).html(markdown.toHTML($(val).text()))
	});
	
}); 


/*******************/
/* INDEXDB*/


	// indexdb via db.js
	var playlist = [];
	var server = 0;
	db.open( {
		  server: 'video-patterns',
		  version: 1,
		  schema: {
		      pattern: {
		          key: { keyPath: 'id' , autoIncrement: true },
		          // Optionally add indexes
		          indexes: {
		              name: { unique: true },
		              answer: { unique: true }
		          }
		      }
		  }
	} ).then( function ( s ) {
		  server = s;    
	} );


/*
Add pattern to index db
**/
function addToFav(pattern){
	server.pattern.add( {  name: pattern } ).then( function ( item ) {
		// add to  
		//playlist.push( item.replace(/\ /g,'-').toLowerCase() );  
	} );
}

/*
Remove pattern from index db
**/
function removeFav(key){
	server.pattern.remove( 1 ).done( function ( key ) {
      alert('removed '+key)
  } );
}


/**/
function clear(){ 
	server.pattern.clear().execute()
    .then(function() { 
			alert('cleared index db')
    });
}    



/*
Fetch all patterns from index db
status: ok
**/
function fetchAll(){ 
	server.pattern.query().all()
      .execute()
      .then( function ( results ) { 
      	var playlst = {}, playlist = [];
      	for(var i=0; i < results.length; i++){
      		playlst[ results[i].name.replace(/\ /g, '-').toLowerCase() ] = results[i].name.replace(/\ /g, '-').toLowerCase();
      	}
      	for(var el in playlst){
      		if(playlst.hasOwnProperty(el)){
      			playlist.push( el );	
      		}
      	}
      	
      	alert(JSON.stringify(playlst));
      	$('.portfolio-item').each(function(i,val){ //alert( $(val).attr('id') )
      		if( playlist.indexOf( $(val).attr('id') ) == -1 ){
      			$(val).hide();
      		}
      	});
        
      });
}


/*
The following line need to be changed regarding the underlaying server
**/ 
var server = '';




/*
// guided tour
function startIntro(){
        var intro = introJs();
          intro.setOptions({
            steps: [
              {intro: "Herzlich willkommen zur Tour"},
              {
                element: document.querySelector('h1')[0],
                intro: "Willkommen bei der E-Tutoren Qualifizierung!"
              },
              {
                element: document.querySelectorAll('.user-menu')[0],
                intro: "Dies hier ist Ihr Icon. Durch einen Klick können Sie ihr Profil einsehen oder sich ausloggen.",
                position: 'left'
              },
              {
                element: document.querySelectorAll('.scene-view')[0],
                intro: "Hier gehts zum ersten Video der E-Tutoren Qualifizierung",
                position: 'top'
              }
            ]
          }).setOption('doneLabel', 'Nächste Seite').oncomplete(function() {
          	window.location.href = '/videos/view/52a13d2e2aa9d35f24000074';
        	});

          intro.start();
      } 
      	//introJs().setOption('doneLabel', 'Next page').start().oncomplete(function() {
          //window.location.href = 'second.html?multipage=true';
        //});
   //};
*/
</script> 	

</head>

<body class="">
<header>
	<div class="container">
		<nav class="navbar navbar-default navbar-fixed-top">
			<div class="container">
				<!-- Brand and toggle get grouped for better mobile display -->
				<div class="navbar-header">
				  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				    <span class="sr-only">Toggle navigation</span>
				    <span class="icon-bar"></span>
				    <span class="icon-bar"></span>
				    <span class="icon-bar"></span>
				  </button>
				  <a class="navbar-brand" href="/">Designing Video Interfaces <small>(alpha - work in progress)</small></a>
				</div>

				<!-- Collect the nav links, forms, and other content for toggling -->
				<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
				  <ul class="nav navbar-nav">
				     <li>
				    <a href="/patterns/list">Patterns<span class="sr-only">(current)</span></a>
				    </li>
				    <li>
				    <a href="/portals">Applications<span class="sr-only">(current)</span></a>
				    </li>
				    
				    <li class="dropdown">
				      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Get involved<span class="caret"></span></a>
				      <ul class="dropdown-menu" role="menu">
								
				        <li class="divider"></li>
				        <li><a href="/proto-patterns/list">Pattern Proposals</a></li>
				        <li class="divider"></li>
				        <li><a href="/vi-two">Apply Patterns</a></li>
				       <li><a href="/api">Data API</a></li>
				      </ul>
				    </li>
				  </ul>
				  <!--<form class="navbar-form navbar-left" role="search">
				    <div class="form-group">
				      <input type="text" class="form-control" placeholder="Search">
				    </div>
				    <button type="submit" class="btn btn-default">Submit</button>
				  </form>-->
				  <ul class="nav navbar-nav navbar-right">
				  	<li><a href="/citation">Citation</a></li>
				    <li><a href="/about">About</a></li>
				    <li class="group-area"></li>
						<li class="user-area"></li>
				    <!--<li class="dropdown">
				      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Dropdown <span class="caret"></span></a>
				      <ul class="dropdown-menu" role="menu">
				        <li><a href="#">Action</a></li>
				        <li><a href="#">Another action</a></li>
				        <li><a href="#">Something else here</a></li>
				        <li class="divider"></li>
				        <li><a href="#">Separated link</a></li>
				      </ul>
				    </li>-->
				  </ul>
				</div><!-- /.navbar-collapse -->
			</div><!-- /.container-fluid -->
		</nav>
	</div>
</header>

<content>
<%- body %>
</content>
<footer>
<% include footer %>
</footer>


	
</body>
</html>
